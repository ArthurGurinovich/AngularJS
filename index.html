<!DOCTYPE html>
<html lang="en">
    <head>
        <title>AngularJS | Course</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="icon" href="./img/favicon.ico" type="image/x-icon">
        <link rel="shortcut icon" href="./img/favicon.ico" type="image/x-icon">
        <script src="./js/base/angular.min.1.5.js"></script>
        <link rel="stylesheet" type="text/css" href="./css/style.css">
    </head>
    <body>
        <header class="top-header">
            <div class="logo">
                <img src="./img/angular.svg"/>
            </div>
            <div class="title">AngularJS | Training</div>
        </header>
        <div id="content">
            <div class="lesson">
                <div class="title">Lesson 3</div>
                <div class="description" ng-app="myApp">
                    <div ng-controller="myCtrl">
                        <tab-controls name="{{ tabsName }}">
                            <ul class="navbar">
                            <pane title="{{ pane1 }}" on-pane-activated="onFirstPaneActivated(pane)">
                                    <div class="loading">
                                        <img src="./img/spinner.gif" width="30" height="30" alt="Loading...">
                                        <p>Loading...</p>
                                    </div>    
                            </pane>
                            <pane  title=" {{ pane2 }}" on-pane-activated="onSecondPaneActivated(pane)">
                                    <div class="loading">
                                        <img src="./img/spinner.gif" width="30" height="30" alt="Loading...">
                                        <p>Loading...</p>
                                    </div> 
                            </pane>
                            <pane  title="{{ pane3 }}" on-pane-activated="onThirdPaneActivated(pane)">
                                    <div class="loading">
                                        <img src="./img/spinner.gif" width="30" height="30" alt="Loading...">
                                        <p>Loading...</p>
                                    </div> 
                            </pane>
                            </ul>
                        </tab-controls>
                    </div>
                </div>

                    <script>
                        var app = angular.module('myApp', []);
                        app.controller('myCtrl',['$scope', function($scope, $timeout){

                            $scope.openTab = function(pane) {
                                var i;
                                var x = document.getElementsByClassName("pane");
                                for (i = 0; i < x.length; i++) {
                                   x[i].style.display = "none";  
                                }
                                document.getElementById(pane).style.display = "block";  
                            };



                            $scope.tabsName = 'Tabs area';
                            $scope.pane1 = {
                                id: 'Tab1',
                                title: 'Pane 1',
                                description: 'Info for Pane 1',
                                display: 'block',
                                active: false
                            };
                            $scope.pane2 = {
                                id: 'Tab2',
                                title: 'Pane 2',
                                description: 'Info for Pane 2',
                                display: 'none',
                                active: false
                            };
                            $scope.pane3 = {
                                id: 'Tab3',
                                title: 'Pane 3',
                                description: 'Info for Pane 3',
                                display: 'none',
                                active: false
                            };



                            $scope.countUp = function(emit, where){
                                    $scope.openTab(emit.id);
                                 return emit.title + " " + emit.description + " " + where; 
                            };


                            $scope.onFirstPaneActivated = function(pane){
                                setTimeout(function(){
                                    $scope.countUp($scope.pane1, pane)
                                }, 200);
                            };
                            $scope.onSecondPaneActivated = function(pane){
                                setTimeout(function(){
                                    $scope.countUp($scope.pane2, pane)
                                }, 200);
                            };
                            $scope.onThirdPaneActivated = function(pane){
                                setTimeout(function(){
                                    $scope.countUp($scope.pane3, pane)
                                }, 200);
                            };
                        }]);
                        app.directive('tabControls',function(){
                          return {
                            restrict: 'E',
                            scope: {
                                name: '@'
                            },
                            transclude:  true, 
                            template: '<div><h2>{{ name }}</h2><ng-transclude></ng-transclude></div>',                     
                            link: function(scope, el, attr){
                            },
                          }
                        });
                        app.directive('pane',function(){
                          return {
                            restrict: 'E',
                            scope: {
                              setting: '@title',
                              onPaneActivated: '&'
                            },
                            controller: function($scope, $element){
                                $scope.getTitle = function(setting){
                                    var setting = JSON.parse(setting);
                                    return setting.title;
                                };
                                $scope.getId = function(setting){
                                    var setting = JSON.parse(setting);
                                    return setting.id;
                                };
                                $scope.changeState = function(setting){
                                    var setting = JSON.parse(setting);
                                    return setting.display;
                                };
                            },
                            template: '<li><a href="#" ng-click=\'onPaneActivated({pane: true})\'>{{ getTitle(setting) }}</a></li>'+
                            '<div id="{{getId(setting)}}" class="pane" style="display: none">'+
                            '<ng-transclude></ng-transclude></div>',
                            transclude:  true,                          
                            link: function (scope, element, attrs, ctrl, transclude) {
                                
                            }
                          }
                        });

                    </script>
                 </div>   
            </div>
     </div>       
    </body>
</html>